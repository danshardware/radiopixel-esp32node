#pragma once

#include <ostream>
#include <span>
#include "SPD.h"


namespace Color
{
namespace CIEXYZ
{
    template<typename T>
    struct xyY;

    //
    template<typename T>
    struct XYZ
    {
        T X = 0, Y = 0, Z = 0;

        XYZ(T _X = 0, T _Y = 0, T _Z = 0)
            : X(_X), Y(_Y), Z(_Z)
        {
        }

        XYZ(const xyY<T>& xyy);

        bool operator==( const XYZ& rhs ) const
        {
            return X == rhs.X && Y == rhs.Y && Z == rhs.Z;
        }

        XYZ operator+( const XYZ& rhs ) const
        {
            return XYZ{ X + rhs.X, Y + rhs.Y, Z + rhs.Z };
        }

        XYZ& operator+=( const XYZ& rhs )
        {
            X += rhs.X;
            Y += rhs.Y;
            Z += rhs.Z;
            return *this;
        }

        friend std::ostream& operator<<( std::ostream& stream, const XYZ<T>& xyz )
        {
            stream << "( X=" << xyz.X << ", Y=" << xyz.Y << ", Z=" << xyz.Z << " )";
            return stream;
        }
    };

    template<typename T>
    class CIE1931_2deg_Observer;

    // A chromaticity and brightness
    template<typename T>
    struct xyY
    {
        T x = 0, y = 0, Y = 0;

        // the min/max values of the color space for the given observer
        template< typename Observer = CIE1931_2deg_Observer<T>>
        static constexpr std::pair<xyY<T>,xyY<T>> range()
        {
            Observer observer;
            auto contour(observer.contour());
            std::pair<xyY<T>,xyY<T>> _range{ { std::numeric_limits<T>::max(), std::numeric_limits<T>::max()},
                { std::numeric_limits<T>::lowest(), std::numeric_limits<T>::lowest() } };
            for (const auto& xyY : contour)
            {
                _range.first.x = std::min( _range.first.x, xyY.x );
                _range.first.y = std::min( _range.first.y, xyY.y );
                _range.second.x = std::max( _range.second.x, xyY.x );
                _range.second.y = std::max( _range.second.y, xyY.y );
            }
            return _range;
        }

        constexpr xyY(T _x = 0, T _y = 0, T _Y = 0)
            : x(_x), y(_y), Y(_Y)
        {
        }

        constexpr xyY( const XYZ<T>& xyz)
        {
            T XYZ( xyz.X + xyz.Y + xyz.Z );
            x = XYZ ? xyz.X / XYZ : 0;
            y = XYZ ? xyz.Y / XYZ : 0;
            Y = xyz.Y;
        }

        bool operator==( const xyY& rhs ) const
        {
            return x == rhs.x && y == rhs.y && Y == rhs.Y;
        }

        friend std::ostream& operator<<( std::ostream& stream, const xyY<T>& chroma )
        {
            stream << "( x=" << chroma.x << ", y=" << chroma.y << ", Y=" << chroma.Y << " )";
            return stream;
        }
    };

    template<typename T>
    XYZ<T>::XYZ(const xyY<T>& xyy)
        : X(xyy.y ? xyy.Y * xyy.x / xyy.y : 0),
        Y(xyy.Y),
        Z(xyy.y ? xyy.Y * (1 - xyy.x - xyy.y) / xyy.y : 0)
    {
    }

    // An adapter from a chromaticity point to an X,Y Point
    template<typename T>
    struct PointAdapter
    {
        PointAdapter( const xyY<T>& chroma )
            : m_chroma( chroma )
        {
        }

        PointAdapter( T _x, T _y )
            : m_chroma{ _x, _y, 0 }
        {
        }

        T x() const { return m_chroma.x; }
        T y() const { return m_chroma.y; }

        xyY<T> m_chroma;
    };

    // Returns the chromaticity and brightness obtained by mixing the
    // \a emitters together
    template< typename T >
    xyY< T > mix( const std::span< xyY< T > >& emitters )
    {
        XYZ<T> xyz;
        for ( auto emitter: emitters )
        {
            xyz += emitter;
        }
        return xyY<T>{ xyz };
    }

    // Observer base class
    template< typename T >
    class Observer
    {
    public:
        // provide the color matching functions as SPDs
        constexpr Observer( const Color::SPD<T>& x_matching, const Color::SPD<T>& y_matching,
            const Color::SPD<T>& z_matching )
            : m_x_matching( x_matching ), m_y_matching( y_matching ),
            m_z_matching( z_matching )
        {
        }

        // interval of the matching function data
        T delta() const
        {
            return m_x_matching.delta();
        }

        // observes the SPD and returns the xyY chromaticity and brightness
        xyY<T> observe( const Color::SPD<T>& spd ) const
        {
            XYZ<T> xyz;
            for ( T wavelength = spd.start(); wavelength <= spd.end(); wavelength += spd.delta())
            {
                T power( spd.power( wavelength ) );
                xyz.X += power * m_x_matching.power( wavelength ) * spd.delta();
                xyz.Y += power * m_y_matching.power( wavelength ) * spd.delta();
                xyz.Z += power * m_z_matching.power( wavelength ) * spd.delta();
            }

            return xyY<T>( xyz );
        }

        // the counter of points around the chromaticity space for the given wavelengths
        constexpr std::vector<xyY<T>> contour( std::pair<T,T> wavelengths = Color::visible<T>()) const
        {
            std::vector<xyY<T>> points;
            points.reserve((wavelengths.second - wavelengths.first) / delta() + 1);
            for ( T wavelength = wavelengths.first; wavelength <= wavelengths.second; wavelength += delta() )
            {
                SPD<T> spd( wavelength ); // a monochromatic SPD at the wavelength
                points.push_back(observe( spd ));
            }
            return points;
        }

        const Color::SPD<T> x_matching() const { return m_x_matching; }
        const Color::SPD<T> y_matching() const { return m_y_matching; }
        const Color::SPD<T> z_matching() const { return m_z_matching; }

    private:
        Color::SPD<T> m_x_matching, m_y_matching, m_z_matching;
    };


    // The CIE 1931 2 degree standard observer, which "seriously underestimates
    // sensitivity at wavelengths below 460 nm"
    // http://cvrl.ucl.ac.uk/cmfs.htm
    template< typename T >
    class CIE1931_2deg_Observer : public Observer<T>
    {
    public:
        constexpr CIE1931_2deg_Observer() : Observer<T>(
            Color::SPD<T>( 360, 5,
            {
                // cat ~/Downloads/ciexyz31.csv | tr -d '\r'|colrm 1 4|colrm 16| awk '{ printf "%s, ", $0 } !(NR%5) { print "" }'
                0.000129900000, 0.000232100000, 0.000414900000, 0.000741600000, 0.001368000000,
                0.002236000000, 0.004243000000, 0.007650000000, 0.014310000000, 0.023190000000,
                0.043510000000, 0.077630000000, 0.134380000000, 0.214770000000, 0.283900000000,
                0.328500000000, 0.348280000000, 0.348060000000, 0.336200000000, 0.318700000000,
                0.290800000000, 0.251100000000, 0.195360000000, 0.142100000000, 0.095640000000,
                0.057950010000, 0.032010000000, 0.014700000000, 0.004900000000, 0.002400000000,
                0.009300000000, 0.029100000000, 0.063270000000, 0.109600000000, 0.165500000000,
                0.225749900000, 0.290400000000, 0.359700000000, 0.433449900000, 0.512050100000,
                0.594500000000, 0.678400000000, 0.762100000000, 0.842500000000, 0.916300000000,
                0.978600000000, 1.026300000000, 1.056700000000, 1.062200000000, 1.045600000000,
                1.002600000000, 0.938400000000, 0.854449900000, 0.751400000000, 0.642400000000,
                0.541900000000, 0.447900000000, 0.360800000000, 0.283500000000, 0.218700000000,
                0.164900000000, 0.121200000000, 0.087400000000, 0.063600000000, 0.046770000000,
                0.032900000000, 0.022700000000, 0.015840000000, 0.011359160000, 0.008110916000,
                0.005790346000, 0.004109457000, 0.002899327000, 0.002049190000, 0.001439971000,
                0.000999949300, 0.000690078600, 0.000476021300, 0.000332301100, 0.000234826100,
                0.000166150500, 0.000117413000, 0.000083075270, 0.000058706520, 0.000041509940,
                0.000029353260, 0.000020673830, 0.000014559770, 0.000010253980, 0.000007221456,
                0.000005085868, 0.000003581652, 0.000002522525, 0.000001776509, 0.000001251141
            }),
            Color::SPD<T>( 360, 5,
            {
                // cat ~/Downloads/ciexyz31.csv | tr -d '\r'|colrm 1 19|colrm 16| awk '{ printf "%s, ", $0 } !(NR%5) { print "" }'
                0.000003917000, 0.000006965000, 0.000012390000, 0.000022020000, 0.000039000000,
                0.000064000000, 0.000120000000, 0.000217000000, 0.000396000000, 0.000640000000,
                0.001210000000, 0.002180000000, 0.004000000000, 0.007300000000, 0.011600000000,
                0.016840000000, 0.023000000000, 0.029800000000, 0.038000000000, 0.048000000000,
                0.060000000000, 0.073900000000, 0.090980000000, 0.112600000000, 0.139020000000,
                0.169300000000, 0.208020000000, 0.258600000000, 0.323000000000, 0.407300000000,
                0.503000000000, 0.608200000000, 0.710000000000, 0.793200000000, 0.862000000000,
                0.914850100000, 0.954000000000, 0.980300000000, 0.994950100000, 1.000000000000,
                0.995000000000, 0.978600000000, 0.952000000000, 0.915400000000, 0.870000000000,
                0.816300000000, 0.757000000000, 0.694900000000, 0.631000000000, 0.566800000000,
                0.503000000000, 0.441200000000, 0.381000000000, 0.321000000000, 0.265000000000,
                0.217000000000, 0.175000000000, 0.138200000000, 0.107000000000, 0.081600000000,
                0.061000000000, 0.044580000000, 0.032000000000, 0.023200000000, 0.017000000000,
                0.011920000000, 0.008210000000, 0.005723000000, 0.004102000000, 0.002929000000,
                0.002091000000, 0.001484000000, 0.001047000000, 0.000740000000, 0.000520000000,
                0.000361100000, 0.000249200000, 0.000171900000, 0.000120000000, 0.000084800000,
                0.000060000000, 0.000042400000, 0.000030000000, 0.000021200000, 0.000014990000,
                0.000010600000, 0.000007465700, 0.000005257800, 0.000003702900, 0.000002607800,
                0.000001836600, 0.000001293400, 0.000000910930, 0.000000641530, 0.000000451810
            }),
            Color::SPD<T>( 360, 5,
            {
                // cat ~/Downloads/ciexyz31.csv | tr -d '\r'|colrm 1 34|sed s/\$/,/ | awk '{ printf "%s, ", $0 } !(NR%5) { print "" }'
                0.000606100000, 0.001086000000, 0.001946000000, 0.003486000000, 0.006450001000,
                0.010549990000, 0.020050010000, 0.036210000000, 0.067850010000, 0.110200000000,
                0.207400000000, 0.371300000000, 0.645600000000, 1.039050100000, 1.385600000000,
                1.622960000000, 1.747060000000, 1.782600000000, 1.772110000000, 1.744100000000,
                1.669200000000, 1.528100000000, 1.287640000000, 1.041900000000, 0.812950100000,
                0.616200000000, 0.465180000000, 0.353300000000, 0.272000000000, 0.212300000000,
                0.158200000000, 0.111700000000, 0.078249990000, 0.057250010000, 0.042160000000,
                0.029840000000, 0.020300000000, 0.013400000000, 0.008749999000, 0.005749999000,
                0.003900000000, 0.002749999000, 0.002100000000, 0.001800000000, 0.001650001000,
                0.001400000000, 0.001100000000, 0.001000000000, 0.000800000000, 0.000600000000,
                0.000340000000, 0.000240000000, 0.000190000000, 0.000100000000, 0.000049999990,
                0.000030000000, 0.000020000000, 0.000010000000
            }))
        {
        }
    };

    // The CIE 1931 2 degree standard observer,
    // modified by Judd (1951) and Vos (1978), 5 nm intervals
    // http://cvrl.ucl.ac.uk/cmfs.htm
    template< typename T >
    class CIE1931_2deg_Judd_Vos_Observer : public Observer<T>
    {
    public:
        constexpr CIE1931_2deg_Judd_Vos_Observer() : Observer<T>(
            Color::SPD<T>( 380, 5,
            {
                // cat ~/Downloads/ciexyzjv.csv | tr -d '\r'|colrm 1 4|colrm 15| awk '{ printf "%s ", $0 } !(NR%5) { print "" }'
                2.689900e-003, 5.310500e-003, 1.078100e-002, 2.079200e-002, 3.798100e-002,
                6.315700e-002, 9.994100e-002, 1.582400e-001, 2.294800e-001, 2.810800e-001,
                3.109500e-001, 3.307200e-001, 3.333600e-001, 3.167200e-001, 2.888200e-001,
                2.596900e-001, 2.327600e-001, 2.099900e-001, 1.747600e-001, 1.328700e-001,
                9.194400e-002, 5.698500e-002, 3.173100e-002, 1.461300e-002, 4.849100e-003,
                2.321500e-003, 9.289900e-003, 2.927800e-002, 6.379100e-002, 1.108100e-001,
                1.669200e-001, 2.276800e-001, 2.926900e-001, 3.622500e-001, 4.363500e-001,
                5.151300e-001, 5.974800e-001, 6.812100e-001, 7.642500e-001, 8.439400e-001,
                9.163500e-001, 9.770300e-001, 1.023000e+000, 1.051300e+000, 1.055000e+000,
                1.036200e+000, 9.923900e-001, 9.286100e-001, 8.434600e-001, 7.398300e-001,
                6.328900e-001, 5.335100e-001, 4.406200e-001, 3.545300e-001, 2.786200e-001,
                2.148500e-001, 1.616100e-001, 1.182000e-001, 8.575300e-002, 6.307700e-002,
                4.583400e-002, 3.205700e-002, 2.218700e-002, 1.561200e-002, 1.109800e-002,
                7.923300e-003, 5.653100e-003, 4.003900e-003, 2.825300e-003, 1.994700e-003,
                1.399400e-003, 9.698000e-004, 6.684700e-004, 4.614100e-004, 3.207300e-004,
                2.257300e-004, 1.597300e-004, 1.127500e-004, 7.951300e-005, 5.608700e-005,
                3.954100e-005, 2.785200e-005, 1.959700e-005, 1.377000e-005, 9.670000e-006,
                6.791800e-006, 4.770600e-006, 3.355000e-006, 2.353400e-006, 1.637700e-006
            }),
            Color::SPD<T>( 380, 5,
            {
                // cat ~/Downloads/ciexyzjv.csv | tr -d '\r'|colrm 1 18|colrm 15| awk '{ printf "%s ", $0 } !(NR%5) { print "" }'
                2.000000e-004, 3.955600e-004, 8.000000e-004, 1.545700e-003, 2.800000e-003,
                4.656200e-003, 7.400000e-003, 1.177900e-002, 1.750000e-002, 2.267800e-002,
                2.730000e-002, 3.258400e-002, 3.790000e-002, 4.239100e-002, 4.680000e-002,
                5.212200e-002, 6.000000e-002, 7.294200e-002, 9.098000e-002, 1.128400e-001,
                1.390200e-001, 1.698700e-001, 2.080200e-001, 2.580800e-001, 3.230000e-001,
                4.054000e-001, 5.030000e-001, 6.081100e-001, 7.100000e-001, 7.951000e-001,
                8.620000e-001, 9.150500e-001, 9.540000e-001, 9.800400e-001, 9.949500e-001,
                1.000100e+000, 9.950000e-001, 9.787500e-001, 9.520000e-001, 9.155800e-001,
                8.700000e-001, 8.162300e-001, 7.570000e-001, 6.948300e-001, 6.310000e-001,
                5.665400e-001, 5.030000e-001, 4.417200e-001, 3.810000e-001, 3.205200e-001,
                2.650000e-001, 2.170200e-001, 1.750000e-001, 1.381200e-001, 1.070000e-001,
                8.165200e-002, 6.100000e-002, 4.432700e-002, 3.200000e-002, 2.345400e-002,
                1.700000e-002, 1.187200e-002, 8.210000e-003, 5.772300e-003, 4.102000e-003,
                2.929100e-003, 2.091000e-003, 1.482200e-003, 1.047000e-003, 7.401500e-004,
                5.200000e-004, 3.609300e-004, 2.492000e-004, 1.723100e-004, 1.200000e-004,
                8.462000e-005, 6.000000e-005, 4.244600e-005, 3.000000e-005, 2.121000e-005,
                1.498900e-005, 1.058400e-005, 7.465600e-006, 5.259200e-006, 3.702800e-006,
                2.607600e-006, 1.836500e-006, 1.295000e-006, 9.109200e-007, 6.356400e-007
            }),
            Color::SPD<T>( 380, 5,
            {
                // cat ~/Downloads/ciexyzjv.csv | tr -d '\r'|colrm 1 32|sed s/\$/,/ | awk '{ printf "%s ", $0 } !(NR%5) { print "" }'
                1.226000e-002, 2.422200e-002, 4.925000e-002, 9.513500e-002, 1.740900e-001,
                2.901300e-001, 4.605300e-001, 7.316600e-001, 1.065800e+000, 1.314600e+000,
                1.467200e+000, 1.579600e+000, 1.616600e+000, 1.568200e+000, 1.471700e+000,
                1.374000e+000, 1.291700e+000, 1.235600e+000, 1.113800e+000, 9.422000e-001,
                7.559600e-001, 5.864000e-001, 4.466900e-001, 3.411600e-001, 2.643700e-001,
                2.059400e-001, 1.544500e-001, 1.091800e-001, 7.658500e-002, 5.622700e-002,
                4.136600e-002, 2.935300e-002, 2.004200e-002, 1.331200e-002, 8.782300e-003,
                5.857300e-003, 4.049300e-003, 2.921700e-003, 2.277100e-003, 1.970600e-003,
                1.806600e-003, 1.544900e-003, 1.234800e-003, 1.117700e-003, 9.056400e-004,
                6.946700e-004, 4.288500e-004, 3.181700e-004, 2.559800e-004, 1.567900e-004,
                9.769400e-005, 6.894400e-005, 5.116500e-005, 3.601600e-005, 2.423800e-005,
                1.691500e-005, 1.190600e-005, 8.148900e-006, 5.600600e-006, 3.954400e-006,
                2.791200e-006, 1.917600e-006, 1.313500e-006, 9.151900e-007, 6.476700e-007,
                4.635200e-007, 3.330400e-007, 2.382300e-007, 1.702600e-007, 1.220700e-007,
                8.710700e-008, 6.145500e-008, 4.316200e-008, 3.037900e-008, 2.155400e-008,
                1.549300e-008, 1.120400e-008, 8.087300e-009, 5.834000e-009, 4.211000e-009,
                3.038300e-009, 2.190700e-009, 1.577800e-009, 1.134800e-009, 8.156500e-010,
                5.862600e-010, 4.213800e-010, 3.031900e-010, 2.175300e-010, 1.547600e-010
            }))
        {
        }
    };

    // CIE 1964 10 degree observer
    // http://cvrl.ucl.ac.uk/cmfs.htm
    template< typename T >
    class CIE1964_10deg_Observer : public Observer<T>
    {
    public:
        constexpr CIE1964_10deg_Observer() : Observer<T>(
            Color::SPD<T>( 360, 5,
            {
                // cat ciexyz64.csv | tr -d '\r' | colrm 1 17 | colrm 16 | awk '{ printf "%s ", $0 } !(NR%5) { print "" }'
                0.000000122200, 0.000000919270, 0.000005958600, 0.000033266000, 0.000159952000,
                0.000662440000, 0.002361600000, 0.007242300000, 0.019109700000, 0.043400000000,
                0.084736000000, 0.140638000000, 0.204492000000, 0.264737000000, 0.314679000000,
                0.357719000000, 0.383734000000, 0.386726000000, 0.370702000000, 0.342957000000,
                0.302273000000, 0.254085000000, 0.195618000000, 0.132349000000, 0.080507000000,
                0.041072000000, 0.016172000000, 0.005132000000, 0.003816000000, 0.015444000000,
                0.037465000000, 0.071358000000, 0.117749000000, 0.172953000000, 0.236491000000,
                0.304213000000, 0.376772000000, 0.451584000000, 0.529826000000, 0.616053000000,
                0.705224000000, 0.793832000000, 0.878655000000, 0.951162000000, 1.014160000000,
                1.074300000000, 1.118520000000, 1.134300000000, 1.123990000000, 1.089100000000,
                1.030480000000, 0.950740000000, 0.856297000000, 0.754930000000, 0.647467000000,
                0.535110000000, 0.431567000000, 0.343690000000, 0.268329000000, 0.204300000000,
                0.152568000000, 0.112210000000, 0.081260600000, 0.057930000000, 0.040850800000,
                0.028623000000, 0.019941300000, 0.013842000000, 0.009576880000, 0.006605200000,
                0.004552630000, 0.003144700000, 0.002174960000, 0.001505700000, 0.001044760000,
                0.000727450000, 0.000508258000, 0.000356380000, 0.000250969000, 0.000177730000,
                0.000126390000, 0.000090151000, 0.000064525800, 0.000046339000, 0.000033411700,
                0.000024209000, 0.000017611500, 0.000012855000, 0.000009413630, 0.000006913000,
                0.000005093470, 0.000003767100, 0.000002795310, 0.000002082000, 0.000001553140
            }),
            Color::SPD<T>( 360, 5,
            {
                // cat ciexyz64.csv | tr -d '\r' | colrm 1 32 | colrm 16 | awk '{ printf "%s ", $0 } !(NR%5) { print "" }'
                0.000000013398, 0.000000100650, 0.000000651100, 0.000003625000, 0.000017364000,
                0.000071560000, 0.000253400000, 0.000768500000, 0.002004400000, 0.004509000000,
                0.008756000000, 0.014456000000, 0.021391000000, 0.029497000000, 0.038676000000,
                0.049602000000, 0.062077000000, 0.074704000000, 0.089456000000, 0.106256000000,
                0.128201000000, 0.152761000000, 0.185190000000, 0.219940000000, 0.253589000000,
                0.297665000000, 0.339133000000, 0.395379000000, 0.460777000000, 0.531360000000,
                0.606741000000, 0.685660000000, 0.761757000000, 0.823330000000, 0.875211000000,
                0.923810000000, 0.961988000000, 0.982200000000, 0.991761000000, 0.999110000000,
                0.997340000000, 0.982380000000, 0.955552000000, 0.915175000000, 0.868934000000,
                0.825623000000, 0.777405000000, 0.720353000000, 0.658341000000, 0.593878000000,
                0.527963000000, 0.461834000000, 0.398057000000, 0.339554000000, 0.283493000000,
                0.228254000000, 0.179828000000, 0.140211000000, 0.107633000000, 0.081187000000,
                0.060281000000, 0.044096000000, 0.031800400000, 0.022601700000, 0.015905100000,
                0.011130300000, 0.007748800000, 0.005375100000, 0.003717740000, 0.002564560000,
                0.001768470000, 0.001222390000, 0.000846190000, 0.000586440000, 0.000407410000,
                0.000284041000, 0.000198730000, 0.000139550000, 0.000098428000, 0.000069819000,
                0.000049737000, 0.000035540500, 0.000025486000, 0.000018338400, 0.000013249000,
                0.000009619600, 0.000007012800, 0.000005129800, 0.000003764730, 0.000002770810,
                0.000002046130, 0.000001516770, 0.000001128090, 0.000000842160, 0.000000629700
            }),
            Color::SPD<T>( 360, 5,
            {
                // cat ciexyz64.csv | tr -d '\r' | colrm 1 47 | sed s/\$/,/ | awk '{ printf "%s ", $0 } !(NR%5) { print "" }'
                0.000000535027, 0.000004028300, 0.000026143700, 0.000146220000, 0.000704776000,
                0.002927800000, 0.010482200000, 0.032344000000, 0.086010900000, 0.197120000000,
                0.389366000000, 0.656760000000, 0.972542000000, 1.282500000000, 1.553480000000,
                1.798500000000, 1.967280000000, 2.027300000000, 1.994800000000, 1.900700000000,
                1.745370000000, 1.554900000000, 1.317560000000, 1.030200000000, 0.772125000000,
                0.570060000000, 0.415254000000, 0.302356000000, 0.218502000000, 0.159249000000,
                0.112044000000, 0.082248000000, 0.060709000000, 0.043050000000, 0.030451000000,
                0.020584000000, 0.013676000000, 0.007918000000, 0.003988000000, 0.001091000000
            }))
        {
        }
    };

    // This is the 2012 proposed "physiologically relevent" 2 degree
    // observer, at 5 nm intervals
    // http://cvrl.ucl.ac.uk/ciexyzpr.htm
    // http://cvrl.ucl.ac.uk/database/text/cienewxyz/cie2012xyz10.htm
    template< typename T >
    class CIE2006_2deg_Observer : public Observer<T>
    {
    public:
        constexpr CIE2006_2deg_Observer() : Observer<T>(
            Color::SPD<T>( 390, 5,
            {
                // cat lin2012xyz2e_5_7sf.csv | tr -d '\r'|colrm 1 4|colrm 14| awk '{ printf "%s ", $0 } !(NR%5) { print "" }'
                3.769647E-03, 9.382967E-03, 2.214302E-02, 4.742986E-02, 8.953803E-02,
                1.446214E-01, 2.035729E-01, 2.488523E-01, 2.918246E-01, 3.227087E-01,
                3.482554E-01, 3.418483E-01, 3.224637E-01, 2.826646E-01, 2.485254E-01,
                2.219781E-01, 1.806905E-01, 1.291920E-01, 8.182895E-02, 4.600865E-02,
                2.083981E-02, 7.097731E-03, 2.461588E-03, 3.649178E-03, 1.556989E-02,
                4.315171E-02, 7.962917E-02, 1.268468E-01, 1.818026E-01, 2.405015E-01,
                3.098117E-01, 3.804244E-01, 4.494206E-01, 5.280233E-01, 6.133784E-01,
                7.016774E-01, 7.967750E-01, 8.853376E-01, 9.638388E-01, 1.051011E+00,
                1.109767E+00, 1.143620E+00, 1.151033E+00, 1.134757E+00, 1.083928E+00,
                1.007344E+00, 9.142877E-01, 8.135565E-01, 6.924717E-01, 5.755410E-01,
                4.731224E-01, 3.844986E-01, 2.997374E-01, 2.277792E-01, 1.707914E-01,
                1.263808E-01, 9.224597E-02, 6.639960E-02, 4.710606E-02, 3.292138E-02,
                2.262306E-02, 1.575417E-02, 1.096778E-02, 7.608750E-03, 5.214608E-03,
                3.569452E-03, 2.464821E-03, 1.703876E-03, 1.186238E-03, 8.269535E-04,
                5.758303E-04, 4.058303E-04, 2.856577E-04, 2.021853E-04, 1.438270E-04,
                1.024685E-04, 7.347551E-05, 5.259870E-05, 3.806114E-05, 2.758222E-05,
                2.004122E-05, 1.458792E-05, 1.068141E-05, 7.857521E-06, 5.768284E-06,
                4.259166E-06, 3.167765E-06, 2.358723E-06, 1.762465E-06
            }),
            Color::SPD<T>( 390, 5,
            {
                // cat lin2012xyz2e_5_7sf.csv | tr -d '\r'|colrm 1 17|colrm 14| awk '{ printf "%s ", $0 } !(NR%5) { print "" }'
                4.146161E-04, 1.059646E-03, 2.452194E-03, 4.971717E-03, 9.079860E-03,
                1.429377E-02, 2.027369E-02, 2.612106E-02, 3.319038E-02, 4.157940E-02,
                5.033657E-02, 5.743393E-02, 6.472352E-02, 7.238339E-02, 8.514816E-02,
                1.060145E-01, 1.298957E-01, 1.535066E-01, 1.788048E-01, 2.064828E-01,
                2.379160E-01, 2.850680E-01, 3.483536E-01, 4.277595E-01, 5.204972E-01,
                6.206256E-01, 7.180890E-01, 7.946448E-01, 8.575799E-01, 9.071347E-01,
                9.544675E-01, 9.814106E-01, 9.890228E-01, 9.994608E-01, 9.967737E-01,
                9.902549E-01, 9.732611E-01, 9.424569E-01, 8.963613E-01, 8.587203E-01,
                8.115868E-01, 7.544785E-01, 6.918553E-01, 6.270066E-01, 5.583746E-01,
                4.895950E-01, 4.229897E-01, 3.609245E-01, 2.980865E-01, 2.416902E-01,
                1.943124E-01, 1.547397E-01, 1.193120E-01, 8.979594E-02, 6.671045E-02,
                4.899699E-02, 3.559982E-02, 2.554223E-02, 1.807939E-02, 1.261573E-02,
                8.661284E-03, 6.027677E-03, 4.195941E-03, 2.910864E-03, 1.995557E-03,
                1.367022E-03, 9.447269E-04, 6.537050E-04, 4.555970E-04, 3.179738E-04,
                2.217445E-04, 1.565566E-04, 1.103928E-04, 7.827442E-05, 5.578862E-05,
                3.981884E-05, 2.860175E-05, 2.051259E-05, 1.487243E-05, 1.080001E-05,
                7.863920E-06, 5.736935E-06, 4.211597E-06, 3.106561E-06, 2.286786E-06,
                1.693147E-06, 1.262556E-06, 9.422514E-07, 7.053860E-07
            }),
            Color::SPD<T>( 390, 5,
            {
                // cat lin2012xyz2e_5_7sf.csv | tr -d '\r'|colrm 1 30|sed s/\$/,/ | awk '{ printf "%s ", $0 } !(NR%5) { print "" }'
                1.847260E-02, 4.609784E-02, 1.096090E-01, 2.369246E-01, 4.508369E-01,
                7.378822E-01, 1.051821E+00, 1.305008E+00, 1.552826E+00, 1.748280E+00,
                1.917479E+00, 1.918437E+00, 1.848545E+00, 1.664439E+00, 1.522157E+00,
                1.428440E+00, 1.250610E+00, 9.991789E-01, 7.552379E-01, 5.617313E-01,
                4.099313E-01, 3.105939E-01, 2.376753E-01, 1.720018E-01, 1.176796E-01,
                8.283548E-02, 5.650407E-02, 3.751912E-02, 2.438164E-02, 1.566174E-02,
                9.846470E-03, 6.131421E-03, 3.790291E-03, 2.327186E-03, 1.432128E-03,
                8.822531E-04, 5.452416E-04, 3.386739E-04, 2.117772E-04, 1.335031E-04,
                8.494468E-05, 5.460706E-05, 3.549661E-05, 2.334738E-05, 1.554631E-05,
                1.048387E-05
            }))
        {
        }
    };

    // This is the 2012 proposed "physiologically relevent" 10 degree
    // observer, at 1 nm intervals
    // http://cvrl.ucl.ac.uk/ciexyzpr.htm
    // http://cvrl.ucl.ac.uk/database/text/cienewxyz/cie2012xyz10.htm
    template< typename T >
    class CIE2006_10deg_Observer : public Observer<T>
    {
    public:
        constexpr CIE2006_10deg_Observer()
            : Observer<T>(
        Color::SPD<T>( 390, 1, {
            // cat lin2012xyz10e_1_7sf.csv | tr -d '\r' | colrm 1 4 | colrm 14 | awk '{ printf "%s ", $0 } !(NR%5) { print "" }'
            2.952420E-03, 3.577275E-03, 4.332146E-03, 5.241609E-03, 6.333902E-03,
            7.641137E-03, 9.199401E-03, 1.104869E-02, 1.323262E-02, 1.579791E-02,
            1.879338E-02, 2.226949E-02, 2.627978E-02, 3.087862E-02, 3.611890E-02,
            4.204986E-02, 4.871256E-02, 5.612868E-02, 6.429866E-02, 7.319818E-02,
            8.277331E-02, 9.295327E-02, 1.037137E-01, 1.150520E-01, 1.269771E-01,
            1.395127E-01, 1.526661E-01, 1.663054E-01, 1.802197E-01, 1.941448E-01,
            2.077647E-01, 2.207911E-01, 2.332355E-01, 2.452462E-01, 2.570397E-01,
            2.688989E-01, 2.810677E-01, 2.933967E-01, 3.055933E-01, 3.173165E-01,
            3.281798E-01, 3.378678E-01, 3.465097E-01, 3.543953E-01, 3.618655E-01,
            3.693084E-01, 3.770107E-01, 3.846850E-01, 3.918591E-01, 3.980192E-01,
            4.026189E-01, 4.052637E-01, 4.062482E-01, 4.060660E-01, 4.052283E-01,
            4.042529E-01, 4.034808E-01, 4.025362E-01, 4.008675E-01, 3.979327E-01,
            3.932139E-01, 3.864108E-01, 3.779513E-01, 3.684176E-01, 3.583473E-01,
            3.482214E-01, 3.383830E-01, 3.288309E-01, 3.194977E-01, 3.103345E-01,
            3.013112E-01, 2.923754E-01, 2.833273E-01, 2.739463E-01, 2.640352E-01,
            2.534221E-01, 2.420135E-01, 2.299346E-01, 2.173617E-01, 2.044672E-01,
            1.914176E-01, 1.783672E-01, 1.654407E-01, 1.527391E-01, 1.403439E-01,
            1.283167E-01, 1.167124E-01, 1.056121E-01, 9.508569E-02, 8.518206E-02,
            7.593120E-02, 6.733159E-02, 5.932018E-02, 5.184106E-02, 4.486119E-02,
            3.836770E-02, 3.237296E-02, 2.692095E-02, 2.204070E-02, 1.773951E-02,
            1.400745E-02, 1.082291E-02, 8.168996E-03, 6.044623E-03, 4.462638E-03,
            3.446810E-03, 3.009513E-03, 3.090744E-03, 3.611221E-03, 4.491435E-03,
            5.652072E-03, 7.035322E-03, 8.669631E-03, 1.060755E-02, 1.290468E-02,
            1.561956E-02, 1.881640E-02, 2.256923E-02, 2.694456E-02, 3.199910E-02,
            3.778185E-02, 4.430635E-02, 5.146516E-02, 5.912224E-02, 6.714220E-02,
            7.538941E-02, 8.376697E-02, 9.233581E-02, 1.011940E-01, 1.104362E-01,
            1.201511E-01, 1.303960E-01, 1.411310E-01, 1.522944E-01, 1.638288E-01,
            1.756832E-01, 1.878114E-01, 2.001621E-01, 2.126822E-01, 2.253199E-01,
            2.380254E-01, 2.507787E-01, 2.636778E-01, 2.768607E-01, 2.904792E-01,
            3.046991E-01, 3.196485E-01, 3.352447E-01, 3.513290E-01, 3.677148E-01,
            3.841856E-01, 4.005312E-01, 4.166669E-01, 4.325420E-01, 4.481063E-01,
            4.633109E-01, 4.781440E-01, 4.927483E-01, 5.073315E-01, 5.221315E-01,
            5.374170E-01, 5.534217E-01, 5.701242E-01, 5.874093E-01, 6.051269E-01,
            6.230892E-01, 6.410999E-01, 6.590659E-01, 6.769436E-01, 6.947143E-01,
            7.123849E-01, 7.299978E-01, 7.476478E-01, 7.654250E-01, 7.834009E-01,
            8.016277E-01, 8.201041E-01, 8.386843E-01, 8.571936E-01, 8.754652E-01,
            8.933408E-01, 9.106772E-01, 9.273554E-01, 9.432502E-01, 9.582244E-01,
            9.721304E-01, 9.849237E-01, 9.970067E-01, 1.008907E+00, 1.021163E+00,
            1.034327E+00, 1.048753E+00, 1.063937E+00, 1.079166E+00, 1.093723E+00,
            1.106886E+00, 1.118106E+00, 1.127493E+00, 1.135317E+00, 1.141838E+00,
            1.147304E+00, 1.151897E+00, 1.155582E+00, 1.158284E+00, 1.159934E+00,
            1.160477E+00, 1.159890E+00, 1.158259E+00, 1.155692E+00, 1.152293E+00,
            1.148163E+00, 1.143345E+00, 1.137685E+00, 1.130993E+00, 1.123097E+00,
            1.113846E+00, 1.103152E+00, 1.091121E+00, 1.077902E+00, 1.063644E+00,
            1.048485E+00, 1.032546E+00, 1.015870E+00, 9.984859E-01, 9.804227E-01,
            9.617111E-01, 9.424119E-01, 9.227049E-01, 9.027804E-01, 8.828123E-01,
            8.629581E-01, 8.432731E-01, 8.234742E-01, 8.032342E-01, 7.822715E-01,
            7.603498E-01, 7.373739E-01, 7.136470E-01, 6.895336E-01, 6.653567E-01,
            6.413984E-01, 6.178723E-01, 5.948484E-01, 5.723600E-01, 5.504353E-01,
            5.290979E-01, 5.083728E-01, 4.883006E-01, 4.689171E-01, 4.502486E-01,
            4.323126E-01, 4.150790E-01, 3.983657E-01, 3.819846E-01, 3.657821E-01,
            3.496358E-01, 3.334937E-01, 3.174776E-01, 3.017298E-01, 2.863684E-01,
            2.714900E-01, 2.571632E-01, 2.434102E-01, 2.302389E-01, 2.176527E-01,
            2.056507E-01, 1.942251E-01, 1.833530E-01, 1.730097E-01, 1.631716E-01,
            1.538163E-01, 1.449230E-01, 1.364729E-01, 1.284483E-01, 1.208320E-01,
            1.136072E-01, 1.067579E-01, 1.002685E-01, 9.412394E-02, 8.830929E-02,
            8.281010E-02, 7.761208E-02, 7.270064E-02, 6.806167E-02, 6.368176E-02,
            5.954815E-02, 5.564917E-02, 5.197543E-02, 4.851788E-02, 4.526737E-02,
            4.221473E-02, 3.934954E-02, 3.665730E-02, 3.412407E-02, 3.173768E-02,
            2.948752E-02, 2.736717E-02, 2.538113E-02, 2.353356E-02, 2.182558E-02,
            2.025590E-02, 1.881892E-02, 1.749930E-02, 1.628167E-02, 1.515301E-02,
            1.410230E-02, 1.312106E-02, 1.220509E-02, 1.135114E-02, 1.055593E-02,
            9.816228E-03, 9.128517E-03, 8.488116E-03, 7.890589E-03, 7.332061E-03,
            6.809147E-03, 6.319204E-03, 5.861036E-03, 5.433624E-03, 5.035802E-03,
            4.666298E-03, 4.323750E-03, 4.006709E-03, 3.713708E-03, 3.443294E-03,
            3.194041E-03, 2.964424E-03, 2.752492E-03, 2.556406E-03, 2.374564E-03,
            2.205568E-03, 2.048294E-03, 1.902113E-03, 1.766485E-03, 1.640857E-03,
            1.524672E-03, 1.417322E-03, 1.318031E-03, 1.226059E-03, 1.140743E-03,
            1.061495E-03, 9.877949E-04, 9.191847E-04, 8.552568E-04, 7.956433E-04,
            7.400120E-04, 6.880980E-04, 6.397864E-04, 5.949726E-04, 5.535291E-04,
            5.153113E-04, 4.801234E-04, 4.476245E-04, 4.174846E-04, 3.894221E-04,
            3.631969E-04, 3.386279E-04, 3.156452E-04, 2.941966E-04, 2.742235E-04,
            2.556624E-04, 2.384390E-04, 2.224525E-04, 2.076036E-04, 1.938018E-04,
            1.809649E-04, 1.690167E-04, 1.578839E-04, 1.474993E-04, 1.378026E-04,
            1.287394E-04, 1.202644E-04, 1.123502E-04, 1.049725E-04, 9.810596E-05,
            9.172477E-05, 8.579861E-05, 8.028174E-05, 7.513013E-05, 7.030565E-05,
            6.577532E-05, 6.151508E-05, 5.752025E-05, 5.378813E-05, 5.031350E-05,
            4.708916E-05, 4.410322E-05, 4.133150E-05, 3.874992E-05, 3.633762E-05,
            3.407653E-05, 3.195242E-05, 2.995808E-05, 2.808781E-05, 2.633581E-05,
            2.469630E-05, 2.316311E-05, 2.172855E-05, 2.038519E-05, 1.912625E-05,
            1.794555E-05, 1.683776E-05, 1.579907E-05, 1.482604E-05, 1.391527E-05,
            1.306345E-05, 1.226720E-05, 1.152279E-05, 1.082663E-05, 1.017540E-05,
            9.565993E-06, 8.995405E-06, 8.460253E-06, 7.957382E-06, 7.483997E-06,
            7.037621E-06, 6.616311E-06, 6.219265E-06, 5.845844E-06, 5.495311E-06,
            5.166853E-06, 4.859511E-06, 4.571973E-06, 4.302920E-06, 4.051121E-06,
            3.815429E-06, 3.594719E-06, 3.387736E-06, 3.193301E-06, 3.010363E-06,
            2.837980E-06, 2.675365E-06, 2.522020E-06, 2.377511E-06, 2.241417E-06,
            2.113325E-06, 1.992830E-06, 1.879542E-06, 1.773083E-06, 1.673086E-06,
            1.579199E-06
        }),
        Color::SPD<T>( 390, 1, {
            // cat lin2012xyz10e_1_7sf.csv | tr -d '\r' | colrm 1 17 | colrm 14 | awk '{ printf "%s ", $0 } !(NR%5) { print "" }'
            4.076779E-04, 4.977769E-04, 6.064754E-04, 7.370040E-04, 8.929388E-04,
            1.078166E-03, 1.296816E-03, 1.553159E-03, 1.851463E-03, 2.195795E-03,
            2.589775E-03, 3.036799E-03, 3.541926E-03, 4.111422E-03, 4.752618E-03,
            5.474207E-03, 6.285034E-03, 7.188068E-03, 8.181786E-03, 9.260417E-03,
            1.041303E-02, 1.162642E-02, 1.289884E-02, 1.423442E-02, 1.564080E-02,
            1.712968E-02, 1.871265E-02, 2.038394E-02, 2.212935E-02, 2.392985E-02,
            2.576133E-02, 2.760156E-02, 2.945513E-02, 3.133884E-02, 3.327575E-02,
            3.529554E-02, 3.742705E-02, 3.967137E-02, 4.201998E-02, 4.446166E-02,
            4.698226E-02, 4.956742E-02, 5.221219E-02, 5.491387E-02, 5.766919E-02,
            6.047429E-02, 6.332195E-02, 6.619271E-02, 6.906185E-02, 7.190190E-02,
            7.468288E-02, 7.738452E-02, 8.003601E-02, 8.268524E-02, 8.538745E-02,
            8.820537E-02, 9.118925E-02, 9.431041E-02, 9.751346E-02, 1.007349E-01,
            1.039030E-01, 1.069639E-01, 1.099676E-01, 1.129992E-01, 1.161541E-01,
            1.195389E-01, 1.232503E-01, 1.273047E-01, 1.316964E-01, 1.364178E-01,
            1.414586E-01, 1.468003E-01, 1.524002E-01, 1.582021E-01, 1.641400E-01,
            1.701373E-01, 1.761233E-01, 1.820896E-01, 1.880463E-01, 1.940065E-01,
            1.999859E-01, 2.060054E-01, 2.120981E-01, 2.183041E-01, 2.246686E-01,
            2.312426E-01, 2.380741E-01, 2.451798E-01, 2.525682E-01, 2.602479E-01,
            2.682271E-01, 2.765005E-01, 2.850035E-01, 2.936475E-01, 3.023319E-01,
            3.109438E-01, 3.194105E-01, 3.278683E-01, 3.365263E-01, 3.456176E-01,
            3.554018E-01, 3.660893E-01, 3.775857E-01, 3.896960E-01, 4.021947E-01,
            4.148227E-01, 4.273539E-01, 4.398206E-01, 4.523360E-01, 4.650298E-01,
            4.780482E-01, 4.915173E-01, 5.054224E-01, 5.197057E-01, 5.343012E-01,
            5.491344E-01, 5.641302E-01, 5.792416E-01, 5.944264E-01, 6.096388E-01,
            6.248296E-01, 6.399656E-01, 6.550943E-01, 6.702903E-01, 6.856375E-01,
            7.012292E-01, 7.171103E-01, 7.330917E-01, 7.489041E-01, 7.642530E-01,
            7.788199E-01, 7.923410E-01, 8.048510E-01, 8.164747E-01, 8.273520E-01,
            8.376358E-01, 8.474653E-01, 8.568868E-01, 8.659242E-01, 8.746041E-01,
            8.829552E-01, 8.910274E-01, 8.989495E-01, 9.068753E-01, 9.149652E-01,
            9.233858E-01, 9.322325E-01, 9.412862E-01, 9.502378E-01, 9.587647E-01,
            9.665325E-01, 9.732504E-01, 9.788415E-01, 9.832867E-01, 9.865720E-01,
            9.886887E-01, 9.897056E-01, 9.899849E-01, 9.899624E-01, 9.900731E-01,
            9.907500E-01, 9.922826E-01, 9.943837E-01, 9.966221E-01, 9.985649E-01,
            9.997775E-01, 9.999440E-01, 9.992200E-01, 9.978793E-01, 9.961934E-01,
            9.944304E-01, 9.927831E-01, 9.911578E-01, 9.893925E-01, 9.873288E-01,
            9.848127E-01, 9.817253E-01, 9.780714E-01, 9.738860E-01, 9.692028E-01,
            9.640545E-01, 9.584409E-01, 9.522379E-01, 9.452968E-01, 9.374773E-01,
            9.286495E-01, 9.187953E-01, 9.083014E-01, 8.976352E-01, 8.872401E-01,
            8.775360E-01, 8.687920E-01, 8.607474E-01, 8.530233E-01, 8.452535E-01,
            8.370838E-01, 8.282409E-01, 8.187320E-01, 8.086352E-01, 7.980296E-01,
            7.869950E-01, 7.756040E-01, 7.638996E-01, 7.519157E-01, 7.396832E-01,
            7.272309E-01, 7.145878E-01, 7.017926E-01, 6.888866E-01, 6.759103E-01,
            6.629035E-01, 6.498911E-01, 6.368410E-01, 6.237092E-01, 6.104541E-01,
            5.970375E-01, 5.834395E-01, 5.697044E-01, 5.558892E-01, 5.420475E-01,
            5.282296E-01, 5.144746E-01, 5.007881E-01, 4.871687E-01, 4.736160E-01,
            4.601308E-01, 4.467260E-01, 4.334589E-01, 4.203919E-01, 4.075810E-01,
            3.950755E-01, 3.828894E-01, 3.709190E-01, 3.590447E-01, 3.471615E-01,
            3.351794E-01, 3.230562E-01, 3.108859E-01, 2.987840E-01, 2.868527E-01,
            2.751807E-01, 2.638343E-01, 2.528330E-01, 2.421835E-01, 2.318904E-01,
            2.219564E-01, 2.123826E-01, 2.031698E-01, 1.943179E-01, 1.858250E-01,
            1.776882E-01, 1.698926E-01, 1.623822E-01, 1.550986E-01, 1.479918E-01,
            1.410203E-01, 1.341614E-01, 1.274401E-01, 1.208887E-01, 1.145345E-01,
            1.083996E-01, 1.025007E-01, 9.684588E-02, 9.143944E-02, 8.628318E-02,
            8.137687E-02, 7.671708E-02, 7.229404E-02, 6.809696E-02, 6.411549E-02,
            6.033976E-02, 5.676054E-02, 5.336992E-02, 5.016027E-02, 4.712405E-02,
            4.425383E-02, 4.154205E-02, 3.898042E-02, 3.656091E-02, 3.427597E-02,
            3.211852E-02, 3.008192E-02, 2.816001E-02, 2.634698E-02, 2.463731E-02,
            2.302574E-02, 2.150743E-02, 2.007838E-02, 1.873474E-02, 1.747269E-02,
            1.628841E-02, 1.517767E-02, 1.413473E-02, 1.315408E-02, 1.223092E-02,
            1.136106E-02, 1.054190E-02, 9.775050E-03, 9.061962E-03, 8.402962E-03,
            7.797457E-03, 7.243230E-03, 6.734381E-03, 6.265001E-03, 5.830085E-03,
            5.425391E-03, 5.047634E-03, 4.695140E-03, 4.366592E-03, 4.060685E-03,
            3.776140E-03, 3.511578E-03, 3.265211E-03, 3.035344E-03, 2.820496E-03,
            2.619372E-03, 2.430960E-03, 2.254796E-03, 2.090489E-03, 1.937586E-03,
            1.795595E-03, 1.663989E-03, 1.542195E-03, 1.429639E-03, 1.325752E-03,
            1.229980E-03, 1.141734E-03, 1.060269E-03, 9.848854E-04, 9.149703E-04,
            8.499903E-04, 7.895158E-04, 7.333038E-04, 6.811458E-04, 6.328287E-04,
            5.881375E-04, 5.468389E-04, 5.086349E-04, 4.732403E-04, 4.404016E-04,
            4.098928E-04, 3.815137E-04, 3.550902E-04, 3.304668E-04, 3.075030E-04,
            2.860718E-04, 2.660718E-04, 2.474586E-04, 2.301919E-04, 2.142225E-04,
            1.994949E-04, 1.859336E-04, 1.734067E-04, 1.617865E-04, 1.509641E-04,
            1.408466E-04, 1.313642E-04, 1.224905E-04, 1.142060E-04, 1.064886E-04,
            9.931439E-05, 9.265512E-05, 8.647225E-05, 8.072780E-05, 7.538716E-05,
            7.041878E-05, 6.579338E-05, 6.148250E-05, 5.746008E-05, 5.370272E-05,
            5.018934E-05, 4.690245E-05, 4.383167E-05, 4.096780E-05, 3.830123E-05,
            3.582218E-05, 3.351903E-05, 3.137419E-05, 2.937068E-05, 2.749380E-05,
            2.573083E-05, 2.407249E-05, 2.251704E-05, 2.106350E-05, 1.970991E-05,
            1.845353E-05, 1.728979E-05, 1.620928E-05, 1.520262E-05, 1.426169E-05,
            1.337946E-05, 1.255038E-05, 1.177169E-05, 1.104118E-05, 1.035662E-05,
            9.715798E-06, 9.116316E-06, 8.555201E-06, 8.029561E-06, 7.536768E-06,
            7.074424E-06, 6.640464E-06, 6.233437E-06, 5.852035E-06, 5.494963E-06,
            5.160948E-06, 4.848687E-06, 4.556705E-06, 4.283580E-06, 4.027993E-06,
            3.788729E-06, 3.564599E-06, 3.354285E-06, 3.156557E-06, 2.970326E-06,
            2.794625E-06, 2.628701E-06, 2.472248E-06, 2.325030E-06, 2.186768E-06,
            2.057152E-06, 1.935813E-06, 1.822239E-06, 1.715914E-06, 1.616355E-06,
            1.523114E-06, 1.435750E-06, 1.353771E-06, 1.276714E-06, 1.204166E-06,
            1.135758E-06, 1.071181E-06, 1.010243E-06, 9.527779E-07, 8.986224E-07,
            8.476168E-07, 7.996052E-07, 7.544361E-07, 7.119624E-07, 6.720421E-07,
            6.345380E-07
        }),
        Color::SPD<T>( 390, 1, {
            // cat lin2012xyz10e_1_7sf.csv | tr -d '\r' | colrm 1 30 | sed s/\$/,/ | awk '{ printf "%s ", $0 } !(NR%5) { print "" }'
            1.318752E-02, 1.597879E-02, 1.935758E-02, 2.343758E-02, 2.835021E-02,
            3.424588E-02, 4.129467E-02, 4.968641E-02, 5.962964E-02, 7.134926E-02,
            8.508254E-02, 1.010753E-01, 1.195838E-01, 1.408647E-01, 1.651644E-01,
            1.927065E-01, 2.236782E-01, 2.582109E-01, 2.963632E-01, 3.381018E-01,
            3.832822E-01, 4.316884E-01, 4.832440E-01, 5.379345E-01, 5.957740E-01,
            6.568187E-01, 7.210459E-01, 7.878635E-01, 8.563391E-01, 9.253017E-01,
            9.933444E-01, 1.059178E+00, 1.122832E+00, 1.184947E+00, 1.246476E+00,
            1.308674E+00, 1.372628E+00, 1.437661E+00, 1.502449E+00, 1.565456E+00,
            1.624940E+00, 1.679488E+00, 1.729668E+00, 1.776755E+00, 1.822228E+00,
            1.867751E+00, 1.914504E+00, 1.961055E+00, 2.005136E+00, 2.044296E+00,
            2.075946E+00, 2.098231E+00, 2.112591E+00, 2.121427E+00, 2.127239E+00,
            2.132574E+00, 2.139093E+00, 2.144815E+00, 2.146832E+00, 2.142250E+00,
            2.128264E+00, 2.103205E+00, 2.069388E+00, 2.030030E+00, 1.988178E+00,
            1.946651E+00, 1.907521E+00, 1.870689E+00, 1.835578E+00, 1.801657E+00,
            1.768440E+00, 1.735338E+00, 1.701254E+00, 1.665053E+00, 1.625712E+00,
            1.582342E+00, 1.534439E+00, 1.482544E+00, 1.427438E+00, 1.369876E+00,
            1.310576E+00, 1.250226E+00, 1.189511E+00, 1.129050E+00, 1.069379E+00,
            1.010952E+00, 9.541809E-01, 8.995253E-01, 8.473720E-01, 7.980093E-01,
            7.516389E-01, 7.082645E-01, 6.673867E-01, 6.284798E-01, 5.911174E-01,
            5.549619E-01, 5.198843E-01, 4.862772E-01, 4.545497E-01, 4.249955E-01,
            3.978114E-01, 3.730218E-01, 3.502618E-01, 3.291407E-01, 3.093356E-01,
            2.905816E-01, 2.726773E-01, 2.555143E-01, 2.390188E-01, 2.231335E-01,
            2.078158E-01, 1.930407E-01, 1.788089E-01, 1.651287E-01, 1.520103E-01,
            1.394643E-01, 1.275353E-01, 1.163771E-01, 1.061161E-01, 9.682266E-02,
            8.852389E-02, 8.118263E-02, 7.463132E-02, 6.870644E-02, 6.327834E-02,
            5.824484E-02, 5.353812E-02, 4.914863E-02, 4.507511E-02, 4.131175E-02,
            3.784916E-02, 3.467234E-02, 3.175471E-02, 2.907029E-02, 2.659651E-02,
            2.431375E-02, 2.220677E-02, 2.026852E-02, 1.849246E-02, 1.687084E-02,
            1.539505E-02, 1.405450E-02, 1.283354E-02, 1.171754E-02, 1.069415E-02,
            9.753000E-03, 8.886096E-03, 8.089323E-03, 7.359131E-03, 6.691736E-03,
            6.083223E-03, 5.529423E-03, 5.025504E-03, 4.566879E-03, 4.149405E-03,
            3.769336E-03, 3.423302E-03, 3.108313E-03, 2.821650E-03, 2.560830E-03,
            2.323578E-03, 2.107847E-03, 1.911867E-03, 1.734006E-03, 1.572736E-03,
            1.426627E-03, 1.294325E-03, 1.174475E-03, 1.065842E-03, 9.673215E-04,
            8.779264E-04, 7.967847E-04, 7.231502E-04, 6.563501E-04, 5.957678E-04,
            5.408385E-04, 4.910441E-04, 4.459046E-04, 4.049826E-04, 3.678818E-04,
            3.342429E-04, 3.037407E-04, 2.760809E-04, 2.509970E-04, 2.282474E-04,
            2.076129E-04, 1.888948E-04, 1.719127E-04, 1.565030E-04, 1.425177E-04,
            1.298230E-04, 1.182974E-04, 1.078310E-04, 9.832455E-05, 8.968787E-05,
            8.183954E-05, 7.470582E-05, 6.821991E-05, 6.232132E-05, 5.695534E-05,
            5.207245E-05, 4.762781E-05, 4.358082E-05, 3.989468E-05, 3.653612E-05,
            3.347499E-05, 3.068400E-05, 2.813839E-05, 2.581574E-05, 2.369574E-05,
            2.175998E-05, 1.999179E-05, 1.837603E-05, 1.689896E-05, 1.554815E-05,
            1.431231E-05, 1.318119E-05, 1.214548E-05, 1.119673E-05, 1.032727E-05,
            9.530130E-06, 8.798979E-06, 8.128065E-06, 7.512160E-06, 6.946506E-06,
            6.426776E-06
        }))
        {
        }
    };
} // namespace CIEXYZ
} // namespace Color
